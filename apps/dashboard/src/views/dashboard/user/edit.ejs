<%- include('partials/head.ejs', { title: 'Tableau de bord - Édition' ,
    description: 'Configure les sections, apparence et arrière‑plan de ta page.' , robots: 'noindex,nofollow' }) %>
    <link href="https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all.js"></script>
    <style>
        .grid-stack-item-content {
            background-color: #1e293b;
            color: #fff;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #334155;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            cursor: grab;
        }

        .grid-stack-item-content:active {
            cursor: grabbing;
        }

        .grid-stack-item-content .item-label {
            font-size: 12px;
            font-weight: 500;
            text-align: center;
            padding: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            width: 100%;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-slide-up {
            animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
    <%- include('partials/header-dash.ejs', { user: user }) %>

        <div id="mobileEditNotice"
            class="md:hidden fixed inset-0 z-50 bg-slate-900 flex items-center justify-center p-4" role="dialog"
            aria-modal="true">
            <div
                class="relative w-full max-w-lg mx-auto bg-slate-800/85 border border-slate-700 rounded-lg p-5 text-center text-white">
                <button id="mobileEditNoticeClose"
                    class="absolute right-3 top-3 size-8 rounded bg-slate-800 hover:bg-slate-700 text-white">✕</button>
                <h2 class="text-lg font-semibold mb-2">Édition indisponible sur mobile</h2>
                <p class="text-sm text-slate-300 mb-4">L'interface d'édition n'est pas accessible depuis un petit écran.
                    Utilisez un ordinateur ou activez le mode « affichage bureau » de votre navigateur pour modifier
                    votre page.</p>
                <div class="flex items-center justify-center gap-2">
                    <a href="<%= frontendUrl %><% if (typeof plinkk !== 'undefined' && plinkk && plinkk.slug) { %>/<%= plinkk.slug %><% } else { %>/<%= user.id %><% } %>"
                        target="_blank"
                        class="px-3 py-2 rounded bg-emerald-700/80 hover:bg-emerald-600 text-white">Ouvrir la page</a>
                </div>
            </div>
        </div>

        <div class="max-w-[1600px] mx-auto grid grid-cols-12 gap-6 px-4 py-8">
            <%- include('partials/asside_dash.ejs', { active: 'edit' }) %>

                <main class="col-span-12 lg:col-span-10 grid grid-cols-1 xl:grid-cols-12 gap-8">
                    <section class="xl:col-span-7 space-y-6">
                        <div
                            class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 bg-slate-900 border border-slate-800 p-6 rounded-3xl">
                            <div class="min-w-0">
                                <h1 class="text-2xl font-bold text-white flex items-center gap-3">
                                    Configuration
                                    <% if (typeof plinkk !=='undefined' && plinkk) { %>
                                        <span
                                            class="text-sm font-normal text-slate-400 bg-slate-800 px-3 py-1 rounded-full border border-slate-700">
                                            <%= plinkk.name %> <span class="text-slate-500">/</span> <span
                                                    class="text-violet-400">
                                                    <%= plinkk.slug %>
                                                </span>
                                        </span>
                                        <% } %>
                                </h1>
                                <div id="save-status-container"
                                    class="flex items-center gap-2 text-xs font-medium py-1 px-3 bg-slate-800/50 border border-slate-700/50 rounded-full w-fit mt-2 transition-all duration-300">
                                    <span id="status-dot"
                                        class="size-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]"></span>
                                    <span id="status-text" class="text-slate-300">Modifications enregistrées</span>
                                </div>
                            </div>

                            <div class="flex items-center gap-3">
                                <div class="flex items-center gap-3">
                                    <%- include('partials/changePlinkkDropdown.ejs') %>
                                </div>
                            </div>
                        </div>

                        <nav
                            class="bg-slate-900 border border-slate-800 p-2 rounded-2xl overflow-x-auto scrollbar-hide">
                            <ul class="flex gap-2 min-w-max" id="tabs">
                                <li>
                                    <button data-target="#section-profile"
                                        class="tab-btn px-4 py-2.5 rounded-xl text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 transition-all aria-selected:bg-violet-600 aria-selected:text-white aria-selected:shadow-lg aria-selected:shadow-violet-900/20 flex items-center gap-2"
                                        aria-selected="true">
                                        <svg class="size-4" viewBox="0 0 24 24" fill="white">
                                            <path
                                                d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-3.33 0-8 1.67-8 5v1h16v-1c0-3.33-4.67-5-8-5z" />
                                        </svg>
                                        Profil
                                    </button>
                                </li>

                                <li>
                                    <button data-target="#section-appearance"
                                        class="tab-btn px-4 py-2.5 rounded-xl text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 transition-all aria-selected:bg-violet-600 aria-selected:text-white aria-selected:shadow-lg aria-selected:shadow-violet-900/20 flex items-center gap-2">
                                        <svg class="size-4" viewBox="0 0 24 24" fill="white">
                                            <path d="M12 2l4 8h8l-6 5 2 9-8-5-8 5 2-9-6-5h8z" />
                                        </svg>
                                        Apparence
                                    </button>
                                </li>
                                <li>
                                    <button data-target="#section-background"
                                        class="tab-btn px-4 py-2.5 rounded-xl text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 transition-all aria-selected:bg-violet-600 aria-selected:text-white aria-selected:shadow-lg aria-selected:shadow-violet-900/20 flex items-center gap-2">
                                        <svg class="size-4" viewBox="0 0 24 24" fill="white">
                                            <path d="M4 6h16v12H4zM7 9h10v6H7z" />
                                        </svg>
                                        Arrière-plan
                                    </button>
                                </li>
                                <li>
                                    <button data-target="#section-links"
                                        class="tab-btn px-4 py-2.5 rounded-xl text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 transition-all aria-selected:bg-violet-600 aria-selected:text-white aria-selected:shadow-lg aria-selected:shadow-violet-900/20 flex items-center gap-2">
                                        <svg class="size-4" viewBox="0 0 24 24" fill="white">
                                            <path
                                                d="M10.59 13.41L9.17 12l4.24-4.24 1.41 1.41L10.59 13.41zm2.82-2.82L14.83 12 10.59 16.24 9.17 14.83 13.41 10.59z" />
                                        </svg>
                                        Liens
                                    </button>
                                </li>
                                <li>
                                    <button data-target="#section-categories"
                                        class="tab-btn px-4 py-2.5 rounded-xl text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 transition-all aria-selected:bg-violet-600 aria-selected:text-white aria-selected:shadow-lg aria-selected:shadow-violet-900/20 flex items-center gap-2">
                                        <svg class="size-4" viewBox="0 0 24 24" fill="white">
                                            <path <path
                                                d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
                                        </svg>
                                        Catégories
                                    </button>
                                </li>
                                <li>
                                    <button data-target="#section-animations"
                                        class="tab-btn px-4 py-2.5 rounded-xl text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 transition-all aria-selected:bg-violet-600 aria-selected:text-white aria-selected:shadow-lg aria-selected:shadow-violet-900/20 flex items-center gap-2">
                                        <svg class="size-4" viewBox="0 0 24 24" fill="white">
                                            <path d="M2 17h20v2H2zM7 9h10v2H7zM4 13h16v2H4z" />
                                        </svg>
                                        Animations
                                    </button>
                                </li>
                                <li>
                                    <button data-target="#section-statusbar"
                                        class="tab-btn px-4 py-2.5 rounded-xl text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 transition-all aria-selected:bg-violet-600 aria-selected:text-white aria-selected:shadow-lg aria-selected:shadow-violet-900/20 flex items-center gap-2">
                                        <svg class="size-4" viewBox="0 0 24 24" fill="white">
                                            <path d="M3 5h18v2H3zM3 9h18v6H3zM3 17h18v2H3z" />
                                        </svg>
                                        Status
                                    </button>
                                </li>
                                <li>
                                    <button data-target="#section-layout"
                                        class="tab-btn px-4 py-2.5 rounded-xl text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 transition-all aria-selected:bg-violet-600 aria-selected:text-white aria-selected:shadow-lg aria-selected:shadow-violet-900/20 flex items-center gap-2">
                                        <svg class="size-4" viewBox="0 0 24 24" fill="white">
                                            <path d="M4 5h16v2H4zM4 11h10v2H4zM4 11h10v2H4zM4 17h13v2H4z" />
                                        </svg>
                                        Agencement
                                    </button>
                                </li>
                                <li>
                                    <button data-target="#section-history"
                                        class="tab-btn px-4 py-2.5 rounded-xl text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 transition-all aria-selected:bg-violet-600 aria-selected:text-white aria-selected:shadow-lg aria-selected:shadow-violet-900/20 flex items-center gap-2">
                                        <svg class="size-4" viewBox="0 0 24 24" fill="white">
                                            <path
                                                d="M13 3a9 9 0 0 0-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42A8.954 8.954 0 0 0 13 21a9 9 0 0 0 0-18zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z" />
                                        </svg>
                                        Historique
                                    </button>
                                </li>
                            </ul>
                        </nav>

                        <div class="space-y-6">
                            <div id="section-profile"
                                class="bg-slate-900 border border-slate-800 rounded-3xl p-6 shadow-lg animate-slide-up">
                                <%- include('./partials/editor-sections/profile.ejs') %>
                            </div>

                            <div id="section-appearance"
                                class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hidden shadow-lg animate-slide-up">
                                <%- include('./partials/editor-sections/appearance.ejs') %>
                            </div>

                            <div id="section-background"
                                class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hidden shadow-lg animate-slide-up">
                                <%- include('./partials/editor-sections/background.ejs') %>
                            </div>

                            <div id="section-links"
                                class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hidden shadow-lg animate-slide-up">
                                <%- include('./partials/editor-sections/links.ejs') %>
                            </div>

                            <div id="section-categories"
                                class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hidden shadow-lg animate-slide-up">
                                <%- include('./partials/editor-sections/categories.ejs') %>
                            </div>

                            <div id="section-animations"
                                class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hidden shadow-lg animate-slide-up">
                                <%- include('./partials/editor-sections/animations.ejs') %>
                            </div>

                            <div id="section-statusbar"
                                class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hidden shadow-lg animate-slide-up">
                                <%- include('./partials/editor-sections/statusbar.ejs') %>
                            </div>

                            <div id="section-layout"
                                class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hidden shadow-lg animate-slide-up">
                                <div class="mb-6 pb-4 border-b border-slate-800">
                                    <h3 class="text-lg font-semibold text-white">Agencement</h3>
                                    <p class="text-sm text-slate-400">Choisis comment tes liens s'affichent.</p>
                                </div>

                                <div class="grid grid-cols-2 gap-4" id="layoutList">
                                    <label class="cursor-pointer group relative">
                                        <input type="radio" name="layoutMode" value="LIST" class="peer sr-only">
                                        <div
                                            class="p-4 rounded-xl border border-slate-700 bg-slate-800 hover:border-violet-500 peer-checked:border-violet-500 peer-checked:bg-violet-900/10 transition-all">
                                            <div class="font-medium text-white mb-2">Liste</div>
                                            <div
                                                class="h-24 bg-slate-900/50 rounded-lg flex flex-col gap-2 p-2 overflow-hidden">
                                                <div class="h-6 bg-slate-700 rounded w-full"></div>
                                                <div class="h-6 bg-slate-700 rounded w-full"></div>
                                                <div class="h-6 bg-slate-700 rounded w-full"></div>
                                            </div>
                                        </div>
                                    </label>
                                    <label class="cursor-pointer group relative">
                                        <input type="radio" name="layoutMode" value="BENTO" class="peer sr-only">
                                        <div
                                            class="p-4 rounded-xl border border-slate-700 bg-slate-800 hover:border-violet-500 peer-checked:border-violet-500 peer-checked:bg-violet-900/10 transition-all">
                                            <div class="font-medium text-white mb-2">Bento Grid</div>
                                            <div
                                                class="h-24 bg-slate-900/50 rounded-lg grid grid-cols-2 gap-2 p-2 overflow-hidden">
                                                <div class="h-full bg-slate-700 rounded col-span-1"></div>
                                                <div class="h-10 bg-slate-700 rounded col-span-1"></div>
                                                <div class="h-10 bg-slate-700 rounded col-span-1"></div>
                                            </div>
                                        </div>
                                    </label>
                                </div>

                                <div id="bentoEditor" class="hidden mt-6">
                                    <div class="mb-2 flex justify-between items-center">
                                        <span class="text-xs text-slate-400">Glissez-déposez pour réorganiser.</span>
                                        <span class="text-xs text-emerald-500 animate-pulse hidden"
                                            id="bentoAutoSaveIndicator">Enregistré</span>
                                    </div>
                                    <div
                                        class="grid-stack bg-slate-950/50 border border-slate-800 rounded-xl min-h-[300px] p-2">
                                    </div>
                                </div>
                            </div>

                            <div id="section-history"
                                class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hidden shadow-lg animate-slide-up">
                                <div class="mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4">
                                    <div>
                                        <h3 class="text-lg font-semibold text-white">Historique & Sauvegardes</h3>
                                        <p class="text-sm text-slate-400">Restaurez une version précédente de votre
                                            page.</p>
                                    </div>
                                    <div class="flex gap-2">
                                        <button id="refreshHistory"
                                            class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 transition-colors"
                                            title="Actualiser">
                                            <svg class="size-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>

                                <div class="flex p-1 bg-slate-950 rounded-xl mb-6">
                                    <button id="tab-history-auto"
                                        class="flex-1 py-2 text-sm font-medium rounded-lg transition-all bg-white shadow text-slate-900">
                                        Automatique
                                    </button>
                                    <button id="tab-history-manual"
                                        class="flex-1 py-2 text-sm font-medium rounded-lg transition-all text-slate-400 hover:bg-white/[0.12] hover:text-white">
                                        Manuelle
                                    </button>
                                </div>

                                <div id="manual-backup-actions"
                                    class="hidden mb-6 p-4 bg-slate-950 rounded-xl border border-slate-800">
                                    <h4 class="text-sm font-medium text-white mb-3">Créer une sauvegarde</h4>
                                    <div class="flex gap-2">
                                        <input type="text" id="backupName"
                                            placeholder="Nom de la sauvegarde (optionnel)"
                                            class="flex-1 px-4 py-2 rounded-lg bg-slate-900 border border-slate-700 text-slate-200 text-sm focus:border-violet-500 focus:ring-1 focus:ring-violet-500/50 outline-none">
                                        <button onclick="createBackup()"
                                            class="px-4 py-2 bg-violet-600 hover:bg-violet-500 text-white text-sm font-medium rounded-lg transition-colors">
                                            Sauvegarder
                                        </button>
                                    </div>
                                </div>

                                <div id="historyList" class="space-y-3 min-h-[100px]"></div>
                            </div>
                        </div>
                    </section>

                    <aside class="hidden xl:block xl:col-span-5 relative">
                        <div class="sticky top-8">
                            <div
                                class="bg-slate-900 border border-slate-800 rounded-[2.5rem] p-4 shadow-2xl relative overflow-hidden">
                                <div class="absolute top-0 left-0 w-full h-full bg-slate-950 opacity-50 z-0"></div>
                                <div
                                    class="relative z-10 bg-black rounded-[2rem] overflow-hidden border-[6px] border-slate-800 shadow-inner aspect-[9/19] max-h-[85vh] mx-auto">
                                    <iframe id="preview"
                                        src="<%= frontendUrl %><% if (typeof plinkk !== 'undefined' && plinkk && plinkk.slug) { %>/<%= plinkk.slug %><% } else { %>/<%= user.id %><% } %>?preview=1"
                                        class="w-full h-full bg-white" frameborder="0"></iframe>
                                </div>
                                <div
                                    class="absolute bottom-8 left-0 right-0 flex justify-center z-20 pointer-events-none">
                                    <div
                                        class="bg-slate-900/90 backdrop-blur px-4 py-2 rounded-full border border-slate-700 flex items-center gap-4 pointer-events-auto transform translate-y-12 transition-transform hover:translate-y-0 shadow-xl">
                                        <button class="text-slate-400 hover:text-white transition-colors"
                                            onclick="document.getElementById('preview')?.contentWindow?.location.reload()"
                                            title="Recharger">
                                            <svg class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2">
                                                <path d="M23 4v6h-6M1 20v-6h6" />
                                                <path
                                                    d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 1 20.49 15" />
                                            </svg>
                                        </button>
                                        <a href="<%= frontendUrl %><% if (typeof plinkk !== 'undefined' && plinkk && plinkk.slug) { %>/<%= plinkk.slug %><% } else { %>/<%= user.id %><% } %>"
                                            target="_blank" class="text-slate-400 hover:text-white transition-colors"
                                            title="Ouvrir">
                                            <svg class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2">
                                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                                                <polyline points="15 3 21 3 21 9" />
                                                <line x1="10" y1="14" x2="21" y2="3" />
                                            </svg>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </aside>
                </main>
        </div>
        <%- include('./edit/link-modal.ejs') %>
            <%- include('./edit/icon-modal.ejs') %>
                <%- include('./edit/picker-modal.ejs') %>

                    <script>
                        window.__PLINKK_USER_ID__ = "<%= user.id %>";
                        window.__PLINKK_SELECTED_ID__ = "<%= plinkk.id %>";
                        window.__USER_EMAIL__ = "<%= user.email %>";

                        // Auto-save Visual Feedback Functions
                        window.__PLINKK_SHOW_SAVING__ = function () {
                            const dot = document.getElementById('status-dot');
                            const text = document.getElementById('status-text');
                            if (dot && text) {
                                dot.className = 'size-1.5 rounded-full bg-amber-500 shadow-[0_0_8px_rgba(245,158,11,0.5)] transition-all';
                                text.textContent = 'Enregistrement...';
                            }
                        };

                        window.__PLINKK_SHOW_SAVED__ = function () {
                            const dot = document.getElementById('status-dot');
                            const text = document.getElementById('status-text');
                            if (dot && text) {
                                dot.className = 'size-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)] transition-all';
                                text.textContent = 'Modifications enregistrées';
                            }
                        };

                        window.__PLINKK_SHOW_ERROR__ = function () {
                            const dot = document.getElementById('status-dot');
                            const text = document.getElementById('status-text');
                            if (dot && text) {
                                dot.className = 'size-1.5 rounded-full bg-rose-500 shadow-[0_0_8px_rgba(244,63,94,0.5)] transition-all';
                                text.textContent = 'Erreur d\'enregistrement';
                            }
                        };
                    </script>

                    <script type="application/json"
                        id="pages-data"><%- JSON.stringify(typeof pages !== 'undefined' ? pages : []) %></script>
                    <script type="application/json"
                        id="autoopen-data"><%= (typeof autoOpenPlinkkModal !== 'undefined' && autoOpenPlinkkModal) ? 'true' : 'false' %></script>

                    <script>
                        // Mobile Notice Logic
                        (function () {
                            const notice = document.getElementById('mobileEditNotice');
                            const closeBtn = document.getElementById('mobileEditNoticeClose');
                            const main = document.querySelector('main');

                            function checkMobile() {
                                if (!notice || !main) return;
                                // Only hide main content if the notice is visible (mobile)
                                if (window.getComputedStyle(notice).display !== 'none') {
                                    main.classList.add('hidden');
                                    if (notice.classList.contains('hidden')) {
                                        // If notice was manually dismissed, show main
                                        main.classList.remove('hidden');
                                    } else {
                                        notice.classList.remove('hidden'); // ensure it's shown if mobile
                                    }
                                } else {
                                    main.classList.remove('hidden');
                                    notice.classList.add('hidden'); // hide notice on desktop
                                }
                            }

                            if (closeBtn) {
                                closeBtn.addEventListener('click', () => {
                                    notice.classList.add('hidden');
                                    if (main) main.classList.remove('hidden');
                                });
                            }

                            window.addEventListener('resize', checkMobile);
                            checkMobile();
                        })();
                    </script>

                    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
                    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
                    <script type="application/json"
                        id="plinkk-data"><%- JSON.stringify(typeof plinkk !== 'undefined' && plinkk ? plinkk : {}) %></script>
                    <script>
                        try {
                            window.__INITIAL_STATE__ = JSON.parse(document.getElementById('plinkk-data').textContent);
                        } catch (e) {
                            console.error('Failed to parse initial state:', e);
                            window.__INITIAL_STATE__ = {};
                        }
                    </script>

                    <script src="/public/js/dashboard-ui/editor-core.js"></script>
                    <script type="module" src="/public/js/dashboard-ui/index.js"></script>

                    <style>
                        /* UI Utils Styles */
                        .masked-field {
                            background-color: rgba(100, 100, 100, 0.12) !important;
                            opacity: 0.65;
                            cursor: not-allowed;
                        }

                        .masked-field:disabled,
                        .masked-field[readonly] {
                            color: inherit;
                        }

                        .mask-toggle {
                            line-height: 1;
                        }

                        .info-i {
                            display: inline-flex;
                            align-items: center;
                            justify-content: center;
                            width: 14px;
                            height: 14px;
                            font-size: 10px;
                            line-height: 1;
                            border-radius: 9999px;
                            border: 1px solid rgba(148, 163, 184, 0.35);
                            color: #cbd5e1;
                            margin-left: 6px;
                            cursor: help;
                            background: rgba(15, 23, 42, 0.5);
                        }

                        .info-i:hover {
                            background: rgba(30, 41, 59, 0.6);
                            color: #e5e7eb;
                            border-color: rgba(148, 163, 184, 0.6);
                        }

                        .deg-dial {
                            position: relative;
                            width: 72px;
                            height: 72px;
                            border-radius: 100%;
                            border: 1px solid #334155;
                            background: radial-gradient(closest-side, rgba(30, 41, 59, 0.9), rgba(15, 23, 42, 0.9));
                            box-shadow: inset 0 0 0 2px rgba(148, 163, 184, 0.1);
                            outline: none;
                            user-select: none;
                            -webkit-user-select: none;
                            touch-action: none;
                            cursor: grab;
                        }

                        .deg-dial:focus {
                            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.55), inset 0 0 0 2px rgba(148, 163, 184, 0.1);
                        }

                        .deg-dial.is-dragging {
                            cursor: grabbing;
                        }

                        .deg-dial-dot {
                            position: absolute;
                            width: 14px;
                            height: 14px;
                            border-radius: 100%;
                            background: #93c5fd;
                            border: 2px solid #1f2937;
                            top: 50%;
                            left: 50%;
                            box-shadow: 0 0 0 1px rgba(148, 163, 184, 0.35);
                            pointer-events: auto;
                            cursor: grab;
                        }

                        .deg-dial:active .deg-dial-dot,
                        .deg-dial.is-dragging .deg-dial-dot {
                            background: #3b82f6;
                            cursor: grabbing;
                        }
                    </style>
                    </body>

                    </html>