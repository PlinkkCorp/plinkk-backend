<%- include('partials/head.ejs', { title: 'Tableau de bord - Premium' ,
  description: 'Passez à la vitesse supérieure avec Plinkk Premium.' , robots: 'noindex,nofollow' }) %>
  <%- include('partials/header-dash.ejs') %>

    <%- include('pricing/styles') %>

      <div class="max-w-[1600px] mx-auto grid grid-cols-12 gap-6 px-4 py-8">
        <%- include('partials/asside_dash.ejs', { active: 'premium' }) %>

          <main class="col-span-12 lg:col-span-10 space-y-8">

            <% if (locals.mode !=='configure' ) { %>
              <%- include('pricing/hero', { pricingCtaHref: '/premium/configure' ,
                pricingCtaText: 'Configurer mon offre' }) %>
                <% } else { %>
                  <a href="/premium"
                    class="inline-flex items-center gap-2 text-sm text-slate-400 hover:text-white transition-colors group">
                    <svg class="w-4 h-4 transition-transform group-hover:-translate-x-0.5" fill="none"
                      stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                    Retour aux offres
                  </a>
                  <% } %>

                    <%- include('pricing/plans', { pricingContext: (locals.mode==='configure' ? 'dashboard-config'
                      : 'dashboard-preview' ) }) %>

                      <% if (locals.mode !=='configure' ) { %>
                        <!-- Messages de succès/annulation pour les achats -->
                        <div id="payment-success"
                          class="hidden mt-4 p-4 rounded-xl bg-emerald-500/10 border border-emerald-500/20 text-emerald-300 text-sm font-medium">
                          ✅ Paiement réussi ! Vos limites ont été mises à jour.
                        </div>
                        <div id="payment-cancel"
                          class="hidden mt-4 p-4 rounded-xl bg-amber-500/10 border border-amber-500/20 text-amber-300 text-sm font-medium">
                          ⚠️ Paiement annulé. Vous pouvez réessayer à tout moment.
                        </div>

                        <%- include('pricing/comparison') %>

                          <%- include('pricing/extensions') %>

                            <%- include('pricing/faq') %>
                              <% } %>

          </main>
      </div>

      <script>
        (function () {
          const params = new URLSearchParams(window.location.search);
          if (params.get('payment') === 'success') {
            const el = document.getElementById('payment-success');
            if (el) el.classList.remove('hidden');
            window.history.replaceState({}, '', window.location.pathname);
          }
          if (params.get('payment') === 'cancel') {
            const el = document.getElementById('payment-cancel');
            if (el) el.classList.remove('hidden');
            window.history.replaceState({}, '', window.location.pathname);
          }
        })();
      </script>
      <script>
        (function () { try { var ev = '<%= typeof mode !== "undefined" && mode === "configure" ? "config_view" : "premium_view" %>'; if (sessionStorage.getItem('plinkk_t_' + ev)) return; sessionStorage.setItem('plinkk_t_' + ev, '1'); navigator.sendBeacon('/api/track', new Blob([JSON.stringify({ event: ev })], { type: 'application/json' })); } catch (e) { } })();
      </script>
      <%- include('partials/footer.ejs') %>